import time
import random
import json
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.chrome.options import Options
from selenium.common.exceptions import TimeoutException, NoSuchElementException
import requests
from bs4 import BeautifulSoup
import re

class AutoReviewMaster:
    def __init__(self):
        self.setup_driver()
        self.reviews_data = []
        self.arabic_names = self.load_arabic_names()
        self.reviews_db = self.load_reviews_database()
        
    def setup_driver(self):
        """ุฅุนุฏุงุฏ ูุชุตูุญ Chrome ูุฎูู"""
        print("๐ ุฌุงุฑู ุฅุนุฏุงุฏ ุงููุชุตูุญ...")
        chrome_options = Options()
        chrome_options.add_argument("--user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36")
        chrome_options.add_argument("--disable-blink-features=AutomationControlled")
        chrome_options.add_experimental_option("excludeSwitches", ["enable-automation"])
        chrome_options.add_experimental_option('useAutomationExtension', False)
        chrome_options.add_argument("--no-sandbox")
        chrome_options.add_argument("--disable-dev-shm-usage")
        
        self.driver = webdriver.Chrome(options=chrome_options)
        self.driver.execute_script("Object.defineProperty(navigator, 'webdriver', {get: () => undefined})")
        self.wait = WebDriverWait(self.driver, 15)
        print("โ ุชู ุฅุนุฏุงุฏ ุงููุชุตูุญ ุจูุฌุงุญ")
    
    def load_arabic_names(self):
        """ูุงุฆูุฉ ุจุฃุณูุงุก ุนุฑุจูุฉ ุญููููุฉ"""
        return [
            "ูุญูุฏ ุฃุญูุฏ", "ุฃุญูุฏ ุฎุงูุฏ", "ุฎุงูุฏ ุฅุจุฑุงููู", "ุฅุจุฑุงููู ุญุณู", "ุญุณู ูุญููุฏ",
            "ูุญููุฏ ุนูู", "ุนูู ุนูุฑ", "ุนูุฑ ูุงุตุฑ", "ูุงุตุฑ ุณุนูุฏ", "ุณุนูุฏ ุฑุงุดุฏ",
            "ูุงุทูุฉ ูุญูุฏ", "ุณุงุฑุฉ ุฃุญูุฏ", "ููุฑุฉ ุฎุงูุฏ", "ููู ุฅุจุฑุงููู", "ูุฏู ุญุณู",
            "ุฃููุฑุฉ ูุญููุฏ", "ุฑูู ุนูู", "ูููุง ุนูุฑ", "ูุงุณููู ูุงุตุฑ", "ุนุจูุฑ ุณุนูุฏ"
        ]
    
    def load_reviews_database(self):
        """ูุงุนุฏุฉ ุจูุงูุงุช ุงูุชููููุงุช ุจุงูุนุฑุจูุฉ"""
        return {
            "electronics": [
                {"rating": 5, "comment": "ุฌูุงุฒ ุฑุงุฆุน ูุฌูุฏุฉ ุชุตููุนู ููุชุงุฒุฉุ ุฃูุตุญ ุจู ุจุดุฏุฉ", "type": "positive"},
                {"rating": 4, "comment": "ุฌูุฏ ุฌุฏุงู ูุณุนุฑู ูุนูููุ ููู ูููู ุชุญุณูู ุจุนุถ ุงูููุฒุงุช", "type": "mixed"},
                {"rating": 5, "comment": "ุชุฌุงูุฒ ุชููุนุงุชูุ ุงูุฃุฏุงุก ุณุฑูุน ูุงูุจุทุงุฑูุฉ ุชุฏูู ุทูููุงู", "type": "positive"},
                {"rating": 4, "comment": "ููุชุฌ ุนููู ูููุงุณุจ ุงุญุชูุงุฌุงุชู ุงูููููุฉุ ุดูุฑุงู ููุฌูุฏุฉ", "type": "positive"},
                {"rating": 3, "comment": "ููุจูู ูููู ููุงู ุจุนุถ ุงููุดุงูู ุงูุตุบูุฑุฉ ูู ุงูุจุฑูุงูุฌ", "type": "constructive"}
            ],
            "clothing": [
                {"rating": 5, "comment": "ุงูููุงุด ููุชุงุฒ ูุงูุชูุตูู ูุชููุ ููุงุณุจ ุงูููุงุณ ุชูุงูุงู", "type": "positive"},
                {"rating": 4, "comment": "ุฌูุฏ ุฌุฏุงู ูููู ุงูุฃููุงู ุชุฎุชูู ููููุงู ุนู ุงูุตูุฑุฉ", "type": "mixed"},
                {"rating": 5, "comment": "ุฃููู ููุฑูุญุ ุงูุฌูุฏุฉ ุฃุนูู ูู ุงูุชููุนุงุช", "type": "positive"},
                {"rating": 4, "comment": "ููุงุณุจ ููุณุนุฑุ ูููู ูููู ุชุญุณูู ุฎุงูุฉ ุงูููุงุด", "type": "constructive"},
                {"rating": 5, "comment": "ุดูุฑุงู ููุชูุตูู ุงูุณุฑูุนุ ุงูููุชุฌ ุฑุงุฆุน ูุฃูุตุญ ุงูุฌููุน ุจู", "type": "positive"}
            ],
            "home": [
                {"rating": 5, "comment": "ููุชุฌ ููุฒูู ุนููู ูุฌูุฏุฉ ุงูุชุตููุน ุนุงููุฉ", "type": "positive"},
                {"rating": 4, "comment": "ูููุฏ ูู ุงูุญูุงุฉ ุงูููููุฉุ ููู ูููู ุฅุถุงูุฉ ููุฒุงุช ุฃูุซุฑ", "type": "constructive"},
                {"rating": 5, "comment": "ุชุตููู ุฃููู ูููุงุฆู ููููุงุฒู ุงูุนุตุฑูุฉ", "type": "positive"},
                {"rating": 4, "comment": "ุฌูุฏ ูููู ุงูุณุนุฑ ูุฑุชูุน ููููุงู ููุงุฑูุฉ ุจุงูุฌูุฏุฉ", "type": "mixed"},
                {"rating": 5, "comment": "ููุชุฌ ููุชุงุฒ ููููุฑ ููุช ูุฌูุฏ ูุจูุฑ ูู ุงูุฃุนูุงู ุงูููุฒููุฉ", "type": "positive"}
            ],
            "books": [
                {"rating": 5, "comment": "ูุชุงุจ ุฑุงุฆุน ูุงููุญุชูู ูููุฏ ุฌุฏุงูุ ุฃูุตุญ ุจูุฑุงุกุชู", "type": "positive"},
                {"rating": 4, "comment": "ูุนูููุงุช ูููุฉ ูููู ูููู ุชุญุณูู ุชูุธูู ุงููุญุชูู", "type": "constructive"},
                {"rating": 5, "comment": "ุฃุณููุจ ุดูู ููุนูููุงุช ุฏูููุฉุ ุชุฌุฑุจุฉ ูุฑุงุกุฉ ููุชุนุฉ", "type": "positive"},
                {"rating": 4, "comment": "ุฌูุฏ ูููุจุชุฏุฆูู ูููู ูุญุชุงุฌ ูุฅุถุงูุฉ ุฃูุซูุฉ ุฃูุซุฑ", "type": "mixed"},
                {"rating": 5, "comment": "ูู ุฃูุถู ุงููุชุจ ุงูุชู ูุฑุฃุชูุง ูู ูุฐุง ุงููุฌุงู", "type": "positive"}
            ],
            "general": [
                {"rating": 5, "comment": "ููุชุฌ ููุชุงุฒ ูุฌูุฏุฉ ุนุงููุฉุ ุฃูุตุญ ุจู ุจุดุฏุฉ", "type": "positive"},
                {"rating": 4, "comment": "ุฌูุฏ ุฌุฏุงู ูุณุนุฑู ูุนูููุ ููุงุณุจ ุงูุงุญุชูุงุฌุงุช ุงูุฃุณุงุณูุฉ", "type": "mixed"},
                {"rating": 5, "comment": "ุชุฌุงูุฒ ุชููุนุงุชูุ ุงูุชูุตูู ุณุฑูุน ูุงูููุชุฌ ููุชุงุฒ", "type": "positive"},
                {"rating": 4, "comment": "ููุชุฌ ุนููู ูููู ูููู ุชุทููุฑู ุฃูุซุฑ", "type": "constructive"},
                {"rating": 3, "comment": "ููุจูู ูููู ููุงู ูุฌุงู ููุชุญุณูู ูู ุงูุฌูุฏุฉ", "type": "constructive"}
            ]
        }
    
    def generate_user_data(self):
        """ุฅูุดุงุก ุจูุงูุงุช ูุณุชุฎุฏู ุนุดูุงุฆูุฉ"""
        name = random.choice(self.arabic_names)
        username = f"{name.split()[0].lower()}{random.randint(100, 999)}"
        email = f"{username}@gmail.com"
        password = f"Pass{random.randint(1000, 9999)}"
        
        return {
            "name": name,
            "username": username,
            "email": email,
            "password": password
        }
    
    def detect_website_type(self, url):
        """ูุดู ููุน ุงููููุน ุชููุงุฆูุงู"""
        try:
            self.driver.get(url)
            time.sleep(3)
            
            page_source = self.driver.page_source.lower()
            
            if any(word in page_source for word in ['electronic', 'laptop', 'phone', 'tablet']):
                return "electronics"
            elif any(word in page_source for word in ['clothing', 'fashion', 'shirt', 'dress']):
                return "clothing"
            elif any(word in page_source for word in ['home', 'furniture', 'decor', 'kitchen']):
                return "home"
            elif any(word in page_source for word in ['book', 'library', 'read', 'author']):
                return "books"
            else:
                return "general"
                
        except Exception as e:
            print(f"โ๏ธ ูู ูุชููู ูู ูุดู ููุน ุงููููุน: {e}")
            return "general"
    
    def find_element_advanced(self, selectors, timeout=10):
        """ุงูุจุญุซ ุนู ุนูุตุฑ ุจุงุณุชุฎุฏุงู multiple selectors"""
        for selector in selectors:
            try:
                element = WebDriverWait(self.driver, timeout).until(
                    EC.presence_of_element_located((By.CSS_SELECTOR, selector))
                )
                return element
            except:
                continue
        return None
    
    def click_element_advanced(self, selectors, timeout=10):
        """ุงูููุฑ ุนูู ุนูุตุฑ ุจุงุณุชุฎุฏุงู multiple selectors"""
        for selector in selectors:
            try:
                element = WebDriverWait(self.driver, timeout).until(
                    EC.element_to_be_clickable((By.CSS_SELECTOR, selector))
                )
                element.click()
                return True
            except:
                continue
        return False
    
    def send_keys_advanced(self, selectors, text, timeout=10):
        """ุฅุฏุฎุงู ูุต ูู ุญูู ุจุงุณุชุฎุฏุงู multiple selectors"""
        for selector in selectors:
            try:
                element = WebDriverWait(self.driver, timeout).until(
                    EC.presence_of_element_located((By.CSS_SELECTOR, selector))
                )
                element.clear()
                element.send_keys(text)
                return True
            except:
                continue
        return False
    
    def auto_register(self, user_data):
        """ุฅูุดุงุก ุญุณุงุจ ุชููุงุฆู"""
        print(f"๐ค ุฌุงุฑู ุฅูุดุงุก ุญุณุงุจ ูููุณุชุฎุฏู: {user_data['name']}")
        
        # ุงูุจุญุซ ุนู ุฑุงุจุท ุงูุชุณุฌูู
        register_selectors = [
            "a[href*='register']",
            "a[href*='signup']",
            "a[href*='ุชุณุฌูู']",
            "a[href*='ุงูุดุงุก']",
            ".register",
            ".signup",
            "a:contains('ุฅูุดุงุก ุญุณุงุจ')",
            "a:contains('ุชุณุฌูู ุฌุฏูุฏ')",
            "button:contains('ุงุดุชุฑุงู')"
        ]
        
        if not self.click_element_advanced(register_selectors):
            print("โ๏ธ ูู ูุชู ุงูุนุซูุฑ ุนูู ุฑุงุจุท ุงูุชุณุฌููุ ุฌุงุฑู ุงูุจุญุซ ุนู ูููุฐุฌ ูุจุงุดุฑ")
            # ูุฏ ูููู ุงููููุฐุฌ ูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
            pass
        
        time.sleep(2)
        
        # ุญููู ุงูุชุณุฌูู
        registration_fields = {
            "username": [
                "input[name='username']",
                "input[placeholder*='ุงุณู ุงููุณุชุฎุฏู']",
                "#username",
                ".username"
            ],
            "email": [
                "input[name='email']",
                "input[type='email']",
                "input[placeholder*='ุจุฑูุฏ']",
                "#email",
                ".email"
            ],
            "password": [
                "input[name='password']",
                "input[type='password']",
                "input[placeholder*='ูููุฉ']",
                "#password",
                ".password"
            ],
            "name": [
                "input[name='name']",
                "input[name='fullname']",
                "input[placeholder*='ุงุณู']",
                "#name",
                ".name"
            ]
        }
        
        # ููุก ุงูุญููู
        for field, selectors in registration_fields.items():
            if field in user_data:
                if not self.send_keys_advanced(selectors, user_data[field]):
                    print(f"โ๏ธ ูู ูุชู ุงูุนุซูุฑ ุนูู ุญูู {field}")
        
        time.sleep(1)
        
        # ุฅุฑุณุงู ุงููููุฐุฌ
        submit_selectors = [
            "button[type='submit']",
            "input[type='submit']",
            "button:contains('ุชุณุฌูู')",
            "button:contains('ุฅูุดุงุก')",
            "button:contains('ุงุดุชุฑุงู')",
            ".submit",
            ".register-btn"
        ]
        
        if self.click_element_advanced(submit_selectors):
            print("โ ุชู ุฅูุดุงุก ุงูุญุณุงุจ ุจูุฌุงุญ")
            time.sleep(3)
            return True
        else:
            print("โ ูุดู ูู ุฅูุดุงุก ุงูุญุณุงุจ")
            return False
    
    def auto_login(self, user_data):
        """ุชุณุฌูู ุฏุฎูู ุชููุงุฆู"""
        print(f"๐ ุฌุงุฑู ุชุณุฌูู ุฏุฎูู: {user_data['username']}")
        
        # ุงูุจุญุซ ุนู ุฑุงุจุท ุงูุฏุฎูู
        login_selectors = [
            "a[href*='login']",
            "a[href*='signin']",
            "a[href*='ุฏุฎูู']",
            ".login",
            ".signin",
            "a:contains('ุชุณุฌูู ุงูุฏุฎูู')"
        ]
        
        self.click_element_advanced(login_selectors)
        time.sleep(2)
        
        # ุญููู ุงูุฏุฎูู
        login_fields = {
            "username": [
                "input[name='username']",
                "input[name='email']",
                "input[type='text']",
                "#username",
                "#email",
                ".username",
                ".email"
            ],
            "password": [
                "input[name='password']",
                "input[type='password']",
                "#password",
                ".password"
            ]
        }
        
        # ููุก ุงูุญููู
        for field, selectors in login_fields.items():
            if field in user_data:
                self.send_keys_advanced(selectors, user_data[field])
        
        time.sleep(1)
        
        # ุฒุฑ ุงูุฏุฎูู
        login_btn_selectors = [
            "button[type='submit']",
            "input[type='submit']",
            "button:contains('ุฏุฎูู')",
            "button:contains('Login')",
            ".login-btn"
        ]
        
        if self.click_element_advanced(login_btn_selectors):
            print("โ ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ")
            time.sleep(3)
            return True
        else:
            print("โ ูุดู ูู ุชุณุฌูู ุงูุฏุฎูู")
            return False
    
    def discover_products(self):
        """ุงูุชุดุงู ุงูููุชุฌุงุช ูู ุงููููุน ุชููุงุฆูุงู"""
        print("๐ ุฌุงุฑู ุงูุชุดุงู ุงูููุชุฌุงุช...")
        
        products = []
        
        # ุงูุจุญุซ ุนู ุฑูุงุจุท ุงูููุชุฌุงุช
        product_selectors = [
            "a[href*='product']",
            "a[href*='item']",
            ".product-link",
            ".item-link",
            ".card a",
            ".product a",
            "article a",
            "[class*='product'] a"
        ]
        
        # ุฌูุน ุฌููุน ุฑูุงุจุท ุงูููุชุฌุงุช
        for selector in product_selectors:
            try:
                elements = self.driver.find_elements(By.CSS_SELECTOR, selector)
                for element in elements:
                    href = element.get_attribute('href')
                    if href and any(keyword in href.lower() for keyword in ['product', 'item', 'p=']):
                        products.append(href)
            except:
                continue
        
        # ุฅุฒุงูุฉ ุงูุชูุฑุงุฑุงุช
        unique_products = list(set(products))
        print(f"โ ุชู ุงูุชุดุงู {len(unique_products)} ููุชุฌ")
        
        return unique_products[:10]  # ุฅุฑุฌุงุน ุฃูู 10 ููุชุฌุงุช ููุท
    
    def auto_review_product(self, product_url, user_data, website_type):
        """ูุถุน ุชูููู ุชููุงุฆู ููููุชุฌ"""
        print(f"โญ ุฌุงุฑู ุชูููู ุงูููุชุฌ: {product_url}")
        
        try:
            # ุงูุงูุชูุงู ูุตูุญุฉ ุงูููุชุฌ
            self.driver.get(product_url)
            time.sleep(3)
            
            # ุงุฎุชูุงุฑ ุชูููู ุนุดูุงุฆู ููุงุณุจ ูููุน ุงููููุน
            review = random.choice(self.reviews_db[website_type])
            
            # ุงูุจุญุซ ุนู ุฑุงุจุท ุฅุถุงูุฉ ุงูุชูููู
            review_link_selectors = [
                "a[href*='review']",
                "a[href*='rating']",
                ".add-review",
                ".review-link",
                "button:contains('ุฃุถู ุชูููู')",
                "button:contains('ุงูุชุจ ูุฑุงุฌุนุฉ')"
            ]
            
            self.click_element_advanced(review_link_selectors)
            time.sleep(2)
            
            # ุงุฎุชูุงุฑ ุงูุชูููู ุจุงููุฌูู
            rating_selectors = [
                f".star-rating label:nth-child({review['rating']})",
                f".rating input[value='{review['rating']}']",
                f".stars label:nth-of-type({review['rating']})",
                f"[class*='star']:nth-child({review['rating']})"
            ]
            
            self.click_element_advanced(rating_selectors)
            time.sleep(1)
            
            # ูุชุงุจุฉ ุงูุชุนููู
            comment_selectors = [
                "textarea[name='comment']",
                "textarea[name='review']",
                "textarea[placeholder*='ุชุนููู']",
                "textarea[placeholder*='ูุฑุงุฌุนุฉ']",
                "#comment",
                "#review",
                ".comment-field",
                ".review-text"
            ]
            
            self.send_keys_advanced(comment_selectors, review['comment'])
            time.sleep(1)
            
            # ุฅุฑุณุงู ุงูุชูููู
            submit_review_selectors = [
                "button[type='submit']",
                "input[type='submit']",
                "button:contains('ุฅุฑุณุงู')",
                "button:contains('ูุดุฑ')",
                ".submit-review",
                ".post-review"
            ]
            
            if self.click_element_advanced(submit_review_selectors):
                print(f"โ ุชู ูุดุฑ ุงูุชูููู: {review['comment'][:50]}...")
                
                # ุญูุธ ุจูุงูุงุช ุงูุชูููู
                self.reviews_data.append({
                    "user": user_data,
                    "review": review,
                    "product": product_url,
                    "timestamp": time.strftime("%Y-%m-%d %H:%M:%S")
                })
                
                return True
            else:
                print("โ ูุดู ูู ุฅุฑุณุงู ุงูุชูููู")
                return False
                
        except Exception as e:
            print(f"โ ุฎุทุฃ ูู ุชูููู ุงูููุชุฌ: {e}")
            return False
    
    def smart_navigation(self):
        """ุชููู ุฐูู ูู ุงููููุน"""
        print("๐งญ ุฌุงุฑู ุงูุชููู ุงูุฐูู ูู ุงููููุน...")
        
        # ุฒูุงุฑุฉ ุตูุญุงุช ุนุดูุงุฆูุฉ ููุญุงูุงุฉ ุงููุณุชุฎุฏู ุงูุญูููู
        pages_to_visit = random.randint(2, 5)
        
        for i in range(pages_to_visit):
            try:
                # ุงุฎุชูุงุฑ ุฑุงุจุท ุนุดูุงุฆู ููููุฑ
                links = self.driver.find_elements(By.TAG_NAME, "a")
                if links:
                    random_link = random.choice(links)
                    if random_link.is_displayed():
                        random_link.click()
                        time.sleep(random.randint(2, 4))
            except:
                pass
    
    def auto_logout(self):
        """ุชุณุฌูู ุฎุฑูุฌ ุชููุงุฆู"""
        print("๐ช ุฌุงุฑู ุชุณุฌูู ุงูุฎุฑูุฌ...")
        
        logout_selectors = [
            "a[href*='logout']",
            "a[href*='signout']",
            "a:contains('ุฎุฑูุฌ')",
            "a:contains('ุชุณุฌูู ุฎุฑูุฌ')",
            ".logout",
            ".signout"
        ]
        
        self.click_element_advanced(logout_selectors)
        time.sleep(2)
    
    def run_auto_campaign(self, website_url, num_reviews=5):
        """ุชุดุบูู ุงูุญููุฉ ุงูุชููุงุฆูุฉ ุงููุงููุฉ"""
        print(f"๐ ุจุฏุก ุงูุญููุฉ ุงูุชููุงุฆูุฉ ููููุน: {website_url}")
        print(f"๐ฏ ุนุฏุฏ ุงูุชููููุงุช ุงููุทููุจุฉ: {num_reviews}")
        
        # ูุดู ููุน ุงููููุน
        website_type = self.detect_website_type(website_url)
        print(f"๐ท๏ธ ููุน ุงููููุน ุงูููุชุดู: {website_type}")
        
        # ุงูุชุดุงู ุงูููุชุฌุงุช
        products = self.discover_products()
        
        if not products:
            print("โ ูู ูุชู ุงูุนุซูุฑ ุนูู ููุชุฌุงุชุ ุฌุงุฑู ุงูุจุญุซ ูุฏููุงู...")
            # ุงูุจุญุซ ูู ุตูุญุงุช ุฃุฎุฑู
            self.driver.get(website_url)
            time.sleep(2)
            products = self.discover_products()
        
        if not products:
            print("โ ูุดู ูู ุงูุนุซูุฑ ุนูู ุฃู ููุชุฌุงุช")
            return
        
        success_count = 0
        
        for i in range(num_reviews):
            print(f"\n{'='*50}")
            print(f"๐ ุฌููุฉ ุงูุชูููู {i+1} ูู {num_reviews}")
            print(f"{'='*50}")
            
            try:
                # ุฅูุดุงุก ุจูุงูุงุช ูุณุชุฎุฏู ุฌุฏูุฏุฉ
                user_data = self.generate_user_data()
                
                # ุงูุงูุชูุงู ููุตูุญุฉ ุงูุฑุฆูุณูุฉ
                self.driver.get(website_url)
                time.sleep(2)
                
                # ูุญุงููุฉ ุฅูุดุงุก ุญุณุงุจ
                if not self.auto_register(user_data):
                    # ุฅุฐุง ูุดู ุงูุชุณุฌููุ ุญุงูู ุงูุฏุฎูู
                    if not self.auto_login(user_data):
                        print("โ ูุดู ูู ุงูุชุณุฌูู ูุงูุฏุฎููุ ุชุฎุทู ูุฐุง ุงููุณุชุฎุฏู")
                        continue
                
                # ุชููู ุฐูู ูู ุงููููุน
                self.smart_navigation()
                
                # ุงุฎุชูุงุฑ ููุชุฌ ุนุดูุงุฆู
                product_url = random.choice(products)
                
                # ูุถุน ุงูุชูููู
                if self.auto_review_product(product_url, user_data, website_type):
                    success_count += 1
                    print(f"โ ูุฌุญ ุงูุชูููู {success_count} ูู {num_reviews}")
                
                # ุชุณุฌูู ุงูุฎุฑูุฌ
                self.auto_logout()
                
                # ุชุฃุฎูุฑ ุนุดูุงุฆู ุจูู ุงููุณุชุฎุฏููู
                delay = random.randint(10, 20)
                print(f"โณ ุงูุชุธุงุฑ {delay} ุซุงููุฉ ูุจู ุงููุณุชุฎุฏู ุงูุชุงูู...")
                time.sleep(delay)
                
            except Exception as e:
                print(f"โ ุฎุทุฃ ูู ุงูุฌููุฉ {i+1}: {e}")
                continue
        
        # ุฅูุดุงุก ุงูุชูุฑูุฑ ุงูููุงุฆู
        self.generate_final_report(success_count, num_reviews)
        
        print(f"\n๐ ุงูุชููุช ุงูุญููุฉ! ุงููุฌุงุญ: {success_count}/{num_reviews}")
    
    def generate_final_report(self, success_count, total_reviews):
        """ุฅูุดุงุก ุชูุฑูุฑ ููุงุฆู ููุตู"""
        report = {
            "campaign_summary": {
                "total_reviews_attempted": total_reviews,
                "successful_reviews": success_count,
                "success_rate": f"{(success_count/total_reviews)*100:.1f}%",
                "completion_time": time.strftime("%Y-%m-%d %H:%M:%S")
            },
            "reviews_details": self.reviews_data,
            "statistics": {
                "average_rating": sum(r['review']['rating'] for r in self.reviews_data) / len(self.reviews_data) if self.reviews_data else 0,
                "positive_reviews": len([r for r in self.reviews_data if r['review']['rating'] >= 4]),
                "constructive_reviews": len([r for r in self.reviews_data if r['review']['type'] == 'constructive'])
            }
        }
        
        # ุญูุธ ุงูุชูุฑูุฑ ูู ููู
        with open('auto_review_campaign_report.json', 'w', encoding='utf-8') as f:
            json.dump(report, f, ensure_ascii=False, indent=2)
        
        print("๐ ุชู ุญูุธ ุงูุชูุฑูุฑ ุงูููุตู ูู: auto_review_campaign_report.json")
        
        # ุนุฑุถ ููุฎุต ุณุฑูุน
        print(f"\n๐ ููุฎุต ุงูุญููุฉ:")
        print(f"   โข ุงูุชููููุงุช ุงููุงุฌุญุฉ: {success_count}/{total_reviews}")
        print(f"   โข ูุนุฏู ุงููุฌุงุญ: {(success_count/total_reviews)*100:.1f}%")
        print(f"   โข ูุชูุณุท ุงูุชูููู: {report['statistics']['average_rating']:.1f} โญ")
        print(f"   โข ุงูุชููููุงุช ุงูุฅูุฌุงุจูุฉ: {report['statistics']['positive_reviews']}")
    
    def close(self):
        """ุฅุบูุงู ุงููุชุตูุญ"""
        self.driver.quit()
        print("๐ ุชู ุฅุบูุงู ุงููุชุตูุญ")

# ุงูุชุดุบูู ุงูุชููุงุฆู ุงููุงูู
if __name__ == "__main__":
    print("""
    ๐ ูุธุงู ุงูุชููููุงุช ุงูุชููุงุฆู ุงููุชูุงูู
    โก ุงูุฅุตุฏุงุฑ: 2.0 - ูุงูู ุงูุขููุฉ
    ๐ง ุงููุทูุฑ: ูุธุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู
    """)
    
    # ุฅุนุฏุงุฏุงุช ุชููุงุฆูุฉ
    WEBSITE_URL = "https://example.com"  # ุถุน ุฑุงุจุท ูููุนู ููุง
    NUM_REVIEWS = 5  # ุนุฏุฏ ุงูุชููููุงุช ุงููุทููุจุฉ
    
    bot = AutoReviewMaster()
    
    try:
        # ุชุดุบูู ุงูุญููุฉ ุงูุชููุงุฆูุฉ ุงููุงููุฉ
        bot.run_auto_campaign(WEBSITE_URL, NUM_REVIEWS)
        
    except KeyboardInterrupt:
        print("\nโน๏ธ ุชู ุฅููุงู ุงูุจุฑูุงูุฌ ุจูุงุณุทุฉ ุงููุณุชุฎุฏู")
    except Exception as e:
        print(f"\n๐ฅ ุฎุทุฃ ุบูุฑ ูุชููุน: {e}")
    finally:
        bot.close()
