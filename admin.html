<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ± - Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒÙŠ</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="admin-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="admin-brand">
                <h2><i class="fas fa-user-shield"></i> Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ±</h2>
                <div class="admin-info">
                    <span>Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…</span>
                    <small>Ù…Ø³Ø¤ÙˆÙ„ ÙƒØ§Ù…Ù„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª</small>
                </div>
            </div>
            <nav class="admin-nav">
                <a href="#dashboard" class="admin-nav-link active">
                    <i class="fas fa-tachometer-alt"></i>
                    Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                </a>
                <a href="#ai-control" class="admin-nav-link">
                    <i class="fas fa-robot"></i>
                    Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
                </a>
                <a href="#code-editor" class="admin-nav-link">
                    <i class="fas fa-code"></i>
                    Ù…Ø­Ø±Ø± Ø§Ù„Ø£ÙƒÙˆØ§Ø¯
                </a>
                <a href="#file-manager" class="admin-nav-link">
                    <i class="fas fa-folder"></i>
                    Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ù„ÙØ§Øª
                </a>
                <a href="#system-tools" class="admin-nav-link">
                    <i class="fas fa-tools"></i>
                    Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
                </a>
            </nav>
            <div class="admin-actions">
                <button class="btn btn-secondary w-100" onclick="adminManager.logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <!-- Quick Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="systemHealth">100%</div>
                    <div class="stat-label">ØµØ­Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="issuesCount">0</div>
                    <div class="stat-label">Ù…Ø´Ø§ÙƒÙ„ Ù…ÙƒØªØ´ÙØ©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="optimizations">0</div>
                    <div class="stat-label">ØªØ­Ø³ÙŠÙ†Ø§Øª Ù…Ù‚ØªØ±Ø­Ø©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="aiStatus">ğŸŸ¢</div>
                    <div class="stat-label">Ø­Ø§Ù„Ø© Ø§Ù„Ù€ AI</div>
                </div>
            </div>

            <!-- AI Control Center -->
            <div class="admin-ai-dashboard">
                <!-- AI Analysis -->
                <div class="ai-analysis-card">
                    <h3><i class="fas fa-chart-line"></i> ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
                    <div class="analysis-results" id="analysisResults">
                        <p>Ù„Ù… ÙŠØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ Ø£ÙŠ ØªØ­Ù„ÙŠÙ„ Ø¨Ø¹Ø¯</p>
                    </div>
                    <div class="ai-tools-grid">
                        <button class="ai-tool-btn" onclick="adminManager.runFullAnalysis()">
                            <i class="fas fa-search"></i>
                            ÙØ­Øµ ÙƒØ§Ù…Ù„
                        </button>
                        <button class="ai-tool-btn" onclick="adminManager.autoFixAll()">
                            <i class="fas fa-magic"></i>
                            Ø¥ØµÙ„Ø§Ø­ ØªÙ„Ù‚Ø§Ø¦ÙŠ
                        </button>
                        <button class="ai-tool-btn" onclick="adminManager.optimizeSystem()">
                            <i class="fas fa-bolt"></i>
                            ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡
                        </button>
                    </div>
                </div>

                <!-- AI Assistant -->
                <div class="ai-analysis-card">
                    <h3><i class="fas fa-robot"></i> Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h3>
                    <div class="ai-chat-mini">
                        <div class="ai-messages-mini" id="aiMessagesMini">
                            <div class="ai-message bot">
                                Ø£Ù†Ø§ Ø¬Ø§Ù‡Ø² Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø£ÙŠ Ø´ÙŠØ¡!
                            </div>
                        </div>
                        <div class="ai-input-mini">
                            <input type="text" id="aiInputMini" placeholder="Ø§Ø³Ø£Ù„ AI Ø¹Ù† Ø£ÙŠ Ø´ÙŠØ¡...">
                            <button onclick="adminManager.askAI()">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Code Editor -->
            <div class="admin-section">
                <h3><i class="fas fa-code"></i> Ù…Ø­Ø±Ø± Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h3>
                <div class="code-editor">
                    <div class="editor-header">
                        <span>script.js</span>
                        <div class="editor-actions">
                            <button class="btn btn-sm" onclick="adminManager.formatCode()">
                                <i class="fas fa-align-left"></i>
                                ØªÙ†Ø³ÙŠÙ‚
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="adminManager.saveCode()">
                                <i class="fas fa-save"></i>
                                Ø­ÙØ¸
                            </button>
                        </div>
                    </div>
                    <textarea class="editor-content" id="codeEditor" spellcheck="false">
// Ø§ÙƒØªØ¨ Ø£Ùˆ Ø¹Ø¯Ù„ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ù‡Ù†Ø§
// Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ AI Ø³ÙŠØ³Ø§Ø¹Ø¯Ùƒ ÙÙŠ ÙƒØªØ§Ø¨Ø© ÙƒÙˆØ¯ Ø§Ø­ØªØ±Ø§ÙÙŠ

function advancedFeature() {
    console.log('Ù…ÙŠØ²Ø© Ù…ØªÙ‚Ø¯Ù…Ø© ØªØ¹Ù…Ù„!');
    return 'Ù†Ø¬Ø§Ø­';
}
                    </textarea>
                </div>
            </div>

            <!-- File Manager -->
            <div class="admin-section">
                <h3><i class="fas fa-file-upload"></i> Ø±ÙØ¹ ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„ÙØ§Øª</h3>
                <div class="file-upload-area" onclick="document.getElementById('fileUploadAdmin').click()">
                    <i class="fas fa-cloud-upload-alt fa-3x"></i>
                    <p>Ø§Ù†Ù‚Ø± Ù„Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø£Ùˆ Ø§Ø³Ø­Ø¨Ù‡Ø§ Ù‡Ù†Ø§</p>
                    <small>ÙŠØ¯Ø¹Ù… Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ù„ÙØ§Øª</small>
                </div>
                <input type="file" id="fileUploadAdmin" hidden multiple onchange="adminManager.handleFiles(this.files)">
                <div class="uploaded-files" id="uploadedFiles"></div>
            </div>
        </main>
    </div>

    <script src="script.js"></script>
    <script src="ai-assistant.js"></script>
    <script>
        class AdminManager {
            constructor() {
                this.aiAssistant = new AdvancedAIAssistant();
                this.init();
            }

            init() {
                this.checkAdminAccess();
                this.loadSystemInfo();
                this.setupAI();
            }

            checkAdminAccess() {
                if (!localStorage.getItem('admin_session')) {
                    window.location.href = 'index.html';
                    return;
                }
            }

            async loadSystemInfo() {
                const analysis = await this.aiAssistant.quickAnalysis();
                this.updateDashboard(analysis);
            }

            updateDashboard(analysis) {
                document.getElementById('systemHealth').textContent = analysis.healthScore + '%';
                document.getElementById('issuesCount').textContent = analysis.issues.length;
                document.getElementById('optimizations').textContent = analysis.recommendations.length;
            }

            async runFullAnalysis() {
                const analysis = await this.aiAssistant.comprehensiveAnalysis();
                this.displayAnalysis(analysis);
                this.updateDashboard(analysis);
            }

            displayAnalysis(analysis) {
                const resultsDiv = document.getElementById('analysisResults');
                resultsDiv.innerHTML = `
                    <div class="analysis-item">
                        <strong>ØµØ­Ø© Ø§Ù„Ù†Ø¸Ø§Ù…:</strong> ${analysis.healthScore}%
                    </div>
                    <div class="analysis-item">
                        <strong>Ø§Ù„Ù…Ø´Ø§ÙƒÙ„:</strong> ${analysis.issues.length}
                    </div>
                    <div class="analysis-item">
                        <strong>Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª:</strong> ${analysis.recommendations.length}
                    </div>
                `;
            }

            async autoFixAll() {
                const results = await this.aiAssistant.autoFixAll();
                alert(`ØªÙ… Ø¥ØµÙ„Ø§Ø­ ${results.fixed} Ù…Ø´ÙƒÙ„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹`);
                this.loadSystemInfo();
            }

            async optimizeSystem() {
                const optimization = await this.aiAssistant.optimizeSystem();
                alert('ØªÙ… ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­');
                this.loadSystemInfo();
            }

            async askAI() {
                const input = document.getElementById('aiInputMini');
                const message = input.value.trim();
                
                if (!message) return;

                const response = await this.aiAssistant.askUnrestricted(message);
                this.displayAIResponse(response);
                input.value = '';
            }

            displayAIResponse(response) {
                const messagesDiv = document.getElementById('aiMessagesMini');
                const userMsg = document.createElement('div');
                userMsg.className = 'ai-message user';
                userMsg.textContent = response.question;
                messagesDiv.appendChild(userMsg);

                const botMsg = document.createElement('div');
                botMsg.className = 'ai-message bot';
                botMsg.innerHTML = response.answer;
                messagesDiv.appendChild(botMsg);

                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }

            handleFiles(files) {
                const filesDiv = document.getElementById('uploadedFiles');
                filesDiv.innerHTML = '';

                Array.from(files).forEach(file => {
                    const fileElement = document.createElement('div');
                    fileElement.className = 'file-item';
                    fileElement.innerHTML = `
                        <i class="fas fa-file"></i>
                        <span>${file.name}</span>
                        <small>(${(file.size / 1024).toFixed(2)} KB)</small>
                        <button onclick="adminManager.processFile(this)" data-file="${file.name}">
                            <i class="fas fa-cog"></i>
                        </button>
                    `;
                    filesDiv.appendChild(fileElement);
                });
            }

            async processFile(button) {
                const fileName = button.getAttribute('data-file');
                const response = await this.aiAssistant.processFile(fileName);
                alert(`ØªÙ… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù: ${response.result}`);
            }

            formatCode() {
                // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                const editor = document.getElementById('codeEditor');
                // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…ÙƒØªØ¨Ø© ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§
            }

            async saveCode() {
                const code = document.getElementById('codeEditor').value;
                const result = await this.aiAssistant.analyzeCode(code);
                
                if (result.valid) {
                    alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„ÙƒÙˆØ¯ Ø¨Ù†Ø¬Ø§Ø­');
                    // Ø­ÙØ¸ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…
                } else {
                    alert('ÙŠÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯: ' + result.errors.join(', '));
                }
            }

            logout() {
                localStorage.removeItem('admin_session');
                window.location.href = 'index.html';
            }
        }

        const adminManager = new AdminManager();
    </script>
</body>
</html>
